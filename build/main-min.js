function displayUserName(e){document.getElementById("username").innerText=e||""}function logUserOut(){firebase.auth().signOut().then(function(){displayUserName(!1)}).catch(function(e){})}function signUserIn(e){e.preventDefault();let t=new FormData(e.target),s=t.get("email"),n=t.get("password");e.target.reset(),firebase.auth().signInWithEmailAndPassword(s,n).then(function(){let e="users/"+firebase.auth().currentUser.uid;firebase.database().ref(e).once("value").then(function(e){let t=e.val().name;app.username=t,displayUserName(t)})}).catch(function(e){console.log(e.message)})}function signUserUp(e){e.preventDefault();let t=new FormData(e.target),s=t.get("username"),n=t.get("email"),a=t.get("password");e.target.reset(),firebase.auth().createUserWithEmailAndPassword(n,a).then(function(){let e="users/"+firebase.auth().currentUser.uid,t={name:s};firebase.database().ref(e).set(t).then(function(e){displayUserName(s)})}).catch(function(e){console.log("account creation failed")})}function removeDone(){for(let e=TaskArray.length-1;e>=0;e--)1==TaskArray[e].status&&(TaskArray.splice(e,1),saveTasks(),renderTaskList())}function onSubmit(e){e.preventDefault();let t=document.getElementById("task-input").value;if(""!=t){let s=new Task(t);TaskArray.push(s),saveTasks(),e.target.reset(),renderTaskList()}}function createNewTask(e){let t=document.createElement("LI");t.setAttribute("id",e.id),t.setAttribute("data-status",e.status);let s=document.createTextNode(e.name);t.appendChild(s),document.getElementById("task-list").appendChild(t),writeTask(app.userid,e)}function writeTask(e,t){if(app.userid){let s="lists/"+e+"/"+t.id,n={name:t.name,status:t.status};firebase.database().ref(s).set(n)}}function readTask(e){let t="lists/"+e;firebase.database().ref(t).once("value").then(function(e){let t=e.val(),s=Object.keys(t).length,n=Object.keys(t);for(let e=0;e<s;e++){let s=t[n[e]],a=s.name,r=s.status,i={id:n[e],name:a,status:r};TaskArray.push(i),renderTaskList()}})}function clearTaskList(){document.getElementById("task-list").innerHTML=""}function renderTaskList(){let e=TaskArray.length;clearTaskList();for(let t=0;t<e;t++)createNewTask(TaskArray[t]);toggleShowButton()}function changeTaskStatus(e){console.log(e.target);let t=e.target.id,s=TaskArray.length;for(let e=0;e<s;e++){let s=TaskArray[e];if(s.id==t){switch(s.status){case 0:s.status=1;break;case 1:s.status=0}saveTasks(),renderTaskList()}}}function saveTasks(){}function loadTasks(){}function toggleShowButton(){let e=!1,t=TaskArray.length;for(let s=0;s<t;s++)1==TaskArray[s].status&&(e=!0);1==e?document.getElementById("remove").setAttribute("class","show"):document.getElementById("remove").removeAttribute("class")}function showForm(e){let t=document.querySelectorAll(".overlay");for(let s=0;s<t.length;s++)t[s].style.display="none",t[s].getAttribute("id")==e&&(t[s].style.display="flex")}class Task{constructor(e){return this.name=e,this.status=0,this.id=(new Date).getTime(),this}}var TaskArray=[],app={userid:0,username:""};firebase.auth().onAuthStateChanged(function(e){if(e){app.userid=e.uid;let t=document.querySelectorAll(".overlay");for(let e=0;e<t.length;e++)t[e].style.display="none";let s="users/"+app.userid;firebase.database().ref(s).once("value").then(function(e){let t=e.val().name;app.username=t,displayUserName(t)}),readTask(app.userid)}else showForm("signin-box"),clearTaskList()}),window.addEventListener("load",function(){const e=document.getElementById("signup-template"),t=document.getElementById("signin-template");var s=document.importNode(e.content,!0);document.querySelector(".appview").appendChild(s);var n=document.importNode(t.content,!0);document.querySelector(".appview").appendChild(n);const a=document.getElementById("signin-link"),r=document.getElementById("signup-link");showForm("signup-box"),a.addEventListener("click",function(){showForm("signin-box")}),r.addEventListener("click",function(){showForm("signup-box")}),loadTasks(),document.getElementById("signup-form").addEventListener("submit",signUserUp),document.getElementById("signin-form").addEventListener("submit",signUserIn),document.getElementById("logout").addEventListener("click",logUserOut),loadTasks(),document.getElementById("task-form").addEventListener("submit",onSubmit),document.getElementById("task-list").addEventListener("click",changeTaskStatus),document.getElementById("remove").addEventListener("click",removeDone),displayUserName(app.username)});